---
title: "Wybory 2025"
format: 
   html:
     self-contained: true
---

```{r, include=FALSE}
library("tidyverse")
library("scales")
library("broom")
library("kableExtra")
source("wczytaj_dane.R")
source("funkcje.R")
theme_set(ggpubr::theme_pubr(base_size = 18))
```

## Rozkład Benforda

W proteście powołano się między innymi na rozkład Benforda. Przy pewnych założeniach, rozkład częstości występowania pierwszych cyfr rozkłada się w pewien określony sposób: cyfra 1 występuje w około 30,1% przypadkach, cyfra 2 17,6% itd. Najważniejsza założenia: liczby mają wiele rzędów wielkości (setki, tysiące, miliony itd.) oraz powstają w pewnym naturalnym procesie (nie są sztucznie ograniczone). Przykłady to długości rzek, rozmiary populacji zamieszkujących jakiś teren czy stałe fizyczne.

## Liczba uprawnionych

Aby porównanie z rozkładem Benforda miało sens, trzeba najpierw uzasadnić (co jest trudne), że mamy do czynienia z liczbami, które powinny się w ten sposób rozkładać. Nie znajduję dobrego uzasadnienia w przypadku liczby głosów oddanych w każdej komisji na danego kandydata. Przeciwnie: wielkość komisji jest zaplanowany, tak aby nie była ani za duża, ani za mała. Liczba uprawnionych do głosowania to 55,9% przypadków liczba 3-cyfrowa, a w 40,5% liczba 4-cyfrowa, czyli w zasadzie mamy tylko dwa rzędy wielkości. Dodatkowo liczby 4-cyfrowe są w prawie 90% przypadków z przedziału 1000-1999, stąd można się spodziewać nadreprezentacji cyfry 1.

```{r}
#| include: false

wyb25 %>% 
  filter(Nupr_2 > 0) %>% 
  mutate(Liczba_cyfr = str_length(Nupr_2)) %>% 
  count(Liczba_cyfr) %>% 
  mutate(n / sum(n) * 100)

wyb25 %>% 
  filter(Nupr_2 > 0) %>% 
  mutate(Liczba_cyfr = str_length(Nupr_2)) %>% 
  filter(Liczba_cyfr == 4) %>% 
  summarise(mean(Nupr_2 < 2000))

wyb25 %>% 
  filter(N_2 > 0) %>% 
  pivot_longer(c(Nawrocki_2, Trzaskowski_2), names_to = "Kto", values_to = "N") %>% 
  mutate(Liczba_cyfr = str_length(N)) %>% 
  count(Liczba_cyfr) %>% 
  mutate(n / sum(n) * 100)
```

Na poniższym wykresie porównanie z rozkładem Benforda dla liczby uprawnionych. Zgodnie z przewidywaniami, rozkład ten nie ma tutaj zastosowania. Stąd moim zdaniem nie powinniśmy się spodziewać, że mając tylko dwóch kandydatów, liczba głosów --- które jest silnie skorelowana z liczbą uprawnionych --- już będzie miała taki rozkład (choć nie jest to wykluczone).

```{r}
wyb25 %>% 
  filter(Nupr_2 > 0) %>% 
  benford1("Nupr_2", "Liczba uprawnionych do głosowania, 2. tura 2025")
```

## Liczba głosów

Mimo powyższych wątpliwości (które moim zdaniem są wystarczające), przejdźmy do analizy liczby głosów. Poniżej rozkład dla pierwszej cyfry dla Nawrockiego w 2. turze. To ten wykres pojawia się w proteście wyborczym.

```{r}
benford1(wyb25, "Nawrocki_2", "Liczba głosów, Nawrocki, 2. tura 2025", limit = 0.33)
```

Odstępstwo jest bardzo duże, co ma świadczyć o tym, że "manipulacje dotyczyły wyników tego kandydata" (cytat z protestu). Porównajmy z liczbą głosów na Trzaskowskiego.

```{r}
benford1(wyb25, "Trzaskowski_2", "Liczba głosów, Trzaskowski, 2. tura 2025", limit = 0.33)
```

Odstępstwo już również duże, choć mniejsze. Zaraz pokażę, z czego to wynika, ale sprawdźmy jeszcze, czy liczba głosów oddanych na Dudę w poprzednich wyborach jest zgodna z rozkładem Benforda.

```{r}
benford1(wyb20, "Duda_2", "Liczba głosów, Duda, 2. tura 2020", limit = 0.33)
```

Jeśli brak zgodności z tym rozkładem miałby świadczyć o manipulacjach, to wygląda na to, że w poprzednich wyborach były znacznie większe. Tak naprawdę musiałyby być systemowe, w większości komisji.

A dlaczego liczba głosów dla Trzaskowskiego odbiega od rozkład Benforda w mniejszym stopniu? W poniższej tabeli podaję (w procentach), jak często liczba głosów na danego kandydata jest liczbą n-cyfrową.

```{r}
cyfry25 <- wyb25 %>% 
  select(Nawrocki_2, Trzaskowski_2) %>% 
  pivot_longer(c(Nawrocki_2, Trzaskowski_2),
    names_to = "Kto", values_to = "N") %>% 
  mutate(Liczba_cyfr = str_length(N)) %>% 
  count(Kto, Liczba_cyfr) %>% 
  pivot_wider(names_from = Kto, values_from = n) %>% 
  mutate(across(c(Nawrocki_2, Trzaskowski_2), ~ . / sum(.) * 100))

cyfry20 <- wyb20 %>% 
  pivot_longer(c(Duda_2, Trzaskowski_2),
    names_to = "Kto", values_to = "N") %>% 
  mutate(Liczba_cyfr = str_length(N)) %>% 
  count(Kto, Liczba_cyfr) %>% 
  pivot_wider(names_from = Kto, values_from = n, values_fill = 0) %>% 
  mutate(across(c(Duda_2, Trzaskowski_2), ~ . / sum(.) * 100))

cyfry20 %>% 
  select(-Trzaskowski_2) %>% 
  full_join(cyfry25, by = "Liczba_cyfr") %>% 
  drop_na() %>% 
  set_names(c("Liczba cyfr", "Duda 2020", "Nawrocki 2025", "Trzaskowski 2025")) %>% 
  kable(digits = c(0, 2, 2, 2))
```

Ponieważ 4-cyfrowa liczba uprawnionych to były głównie liczby 1000-1999, liczba głosów na kandydata bardzo rzadko była liczbą 4-cyfrową. W przypadku Dudy w aż 92% mamy tylko liczby 3-cyfrowe (stąd rozkład w ogóle nie przypomina Benforda), dla Nawrockiego w 10% przypadków są liczby 2-cyfrowe, a dla Trzaskowskiego w 29% --- stąd rozkład dla niego najbardziej przypomina Benforda. Dodajmy, że te różnice wynikają stąd, że Duda i Nawrocki wygrywali głównie w mniejszych komisjach (na wsi).

## Podsumowanie

Liczba głosów rzeczywiście znacznie odbiega od rozkładu Benforda. Powodem jest to, że w ogóle nie powinna tak się rozkładać.

Jeśli ktoś chciałby sprawdzić, czy obliczenia są poprawne, udostępniam kod języku R.

## Źródła

* [Wyniki wyborów 2020](https://prezydent20200628.pkw.gov.pl/prezydent20200628/pl/dane_w_arkuszach)
* [Wyniki wyborów 2025](https://wybory.gov.pl/prezydent2025/pl/dane_w_arkuszach)
* [Wpis Cezarego Tomczyka](https://x.com/CTomczyk/status/1933872924403864011?t=48ZUSMFkpWer6zjrcSacZQ&s=19)
* [Protest](https://docs.google.com/document/d/1izIyHST5lFWrMfUTUBwX61najOlty9rIs5uovCNcZYk/mobilebasic)
 
 
 
 
 
 
 
 
 
 
 
 

